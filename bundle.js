(()=>{"use strict";var t={194:(t,e,i)=>{i.r(e),i.d(e,{Easing:()=>r,Group:()=>n,Interpolation:()=>o,Sequence:()=>h,Tween:()=>c,VERSION:()=>u,add:()=>f,default:()=>x,getAll:()=>d,nextId:()=>p,now:()=>a,remove:()=>y,removeAll:()=>m,update:()=>_});var s,r={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-r.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*r.Bounce.In(2*t):.5*r.Bounce.Out(2*t-1)+.5}}},a="undefined"==typeof self&&"undefined"!=typeof process&&process.hrtime?function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},n=function(){function t(){this._tweens={},this._tweensAddedDuringUpdate={}}return t.prototype.getAll=function(){var t=this;return Object.keys(this._tweens).map((function(e){return t._tweens[e]}))},t.prototype.removeAll=function(){this._tweens={}},t.prototype.add=function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},t.prototype.remove=function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},t.prototype.update=function(t,e){void 0===t&&(t=a()),void 0===e&&(e=!1);var i=Object.keys(this._tweens);if(0===i.length)return!1;for(;i.length>0;){this._tweensAddedDuringUpdate={};for(var s=0;s<i.length;s++){var r=this._tweens[i[s]],n=!e;r&&!1===r.update(t,n)&&!e&&delete this._tweens[i[s]]}i=Object.keys(this._tweensAddedDuringUpdate)}return!0},t}(),o={Linear:function(t,e){var i=t.length-1,s=i*e,r=Math.floor(s),a=o.Utils.Linear;return e<0?a(t[0],t[1],s):e>1?a(t[i],t[i-1],i-s):a(t[r],t[r+1>i?i:r+1],s-r)},Bezier:function(t,e){for(var i=0,s=t.length-1,r=Math.pow,a=o.Utils.Bernstein,n=0;n<=s;n++)i+=r(1-e,s-n)*r(e,n)*t[n]*a(s,n);return i},CatmullRom:function(t,e){var i=t.length-1,s=i*e,r=Math.floor(s),a=o.Utils.CatmullRom;return t[0]===t[i]?(e<0&&(r=Math.floor(s=i*(1+e))),a(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],s-r)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-s)-t[0]):e>1?t[i]-(a(t[i],t[i],t[i-1],t[i-1],s-i)-t[i]):a(t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2],s-r)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=o.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:(s=[1],function(t){var e=1;if(s[t])return s[t];for(var i=t;i>1;i--)e*=i;return s[t]=e,e}),CatmullRom:function(t,e,i,s,r){var a=.5*(i-t),n=.5*(s-e),o=r*r;return(2*e-2*i+a+n)*(r*o)+(-3*e+3*i-2*a-n)*o+a*r+e}}},h=function(){function t(){}return t.nextId=function(){return t._nextId++},t._nextId=0,t}(),l=new n,c=function(){function t(t,e){void 0===e&&(e=l),this._object=t,this._group=e,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=r.Linear.None,this._interpolationFunction=o.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=h.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return t.prototype.getId=function(){return this._id},t.prototype.isPlaying=function(){return this._isPlaying},t.prototype.isPaused=function(){return this._isPaused},t.prototype.to=function(t,e){return this._valuesEnd=Object.create(t),void 0!==e&&(this._duration=e),this},t.prototype.duration=function(t){return this._duration=t,this},t.prototype.start=function(t){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var e in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(e),this._valuesStart[e]=this._valuesStartRepeat[e];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==t?"string"==typeof t?a()+parseFloat(t):t:a(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},t.prototype._setupProperties=function(t,e,i,s){for(var r in i){var a=t[r],n=Array.isArray(a),o=n?"array":typeof a,h=!n&&Array.isArray(i[r]);if("undefined"!==o&&"function"!==o){if(h){var l=i[r];if(0===l.length)continue;l=l.map(this._handleRelativeValue.bind(this,a)),i[r]=[a].concat(l)}if("object"!==o&&!n||!a||h)void 0===e[r]&&(e[r]=a),n||(e[r]*=1),s[r]=h?i[r].slice().reverse():e[r]||0;else{for(var c in e[r]=n?[]:{},a)e[r][c]=a[c];s[r]=n?[]:{},this._setupProperties(a,e[r],i[r],s[r])}}}},t.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},t.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},t.prototype.pause=function(t){return void 0===t&&(t=a()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=t,this._group&&this._group.remove(this)),this},t.prototype.resume=function(t){return void 0===t&&(t=a()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=t-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},t.prototype.stopChainedTweens=function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop();return this},t.prototype.group=function(t){return this._group=t,this},t.prototype.delay=function(t){return this._delayTime=t,this},t.prototype.repeat=function(t){return this._initialRepeat=t,this._repeat=t,this},t.prototype.repeatDelay=function(t){return this._repeatDelayTime=t,this},t.prototype.yoyo=function(t){return this._yoyo=t,this},t.prototype.easing=function(t){return this._easingFunction=t,this},t.prototype.interpolation=function(t){return this._interpolationFunction=t,this},t.prototype.chain=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._chainedTweens=t,this},t.prototype.onStart=function(t){return this._onStartCallback=t,this},t.prototype.onUpdate=function(t){return this._onUpdateCallback=t,this},t.prototype.onRepeat=function(t){return this._onRepeatCallback=t,this},t.prototype.onComplete=function(t){return this._onCompleteCallback=t,this},t.prototype.onStop=function(t){return this._onStopCallback=t,this},t.prototype.update=function(t,e){if(void 0===t&&(t=a()),void 0===e&&(e=!0),this._isPaused)return!0;var i,s,r=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(t>r)return!1;e&&this.start(t)}if(this._goToEnd=!1,t<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),s=(t-this._startTime)/this._duration,s=0===this._duration||s>1?1:s;var n=this._easingFunction(s);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,n),this._onUpdateCallback&&this._onUpdateCallback(this._object,s),1===s){if(this._repeat>0){for(i in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!=typeof this._valuesEnd[i]||(this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(this._valuesEnd[i])),this._yoyo&&this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var o=0,h=this._chainedTweens.length;o<h;o++)this._chainedTweens[o].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},t.prototype._updateProperties=function(t,e,i,s){for(var r in i)if(void 0!==e[r]){var a=e[r]||0,n=i[r],o=Array.isArray(t[r]),h=Array.isArray(n);!o&&h?t[r]=this._interpolationFunction(n,s):"object"==typeof n&&n?this._updateProperties(t[r],a,n,s):"number"==typeof(n=this._handleRelativeValue(a,n))&&(t[r]=a+(n-a)*s)}},t.prototype._handleRelativeValue=function(t,e){return"string"!=typeof e?e:"+"===e.charAt(0)||"-"===e.charAt(0)?t+parseFloat(e):parseFloat(e)},t.prototype._swapEndStartRepeatValues=function(t){var e=this._valuesStartRepeat[t],i=this._valuesEnd[t];this._valuesStartRepeat[t]="string"==typeof i?this._valuesStartRepeat[t]+parseFloat(i):this._valuesEnd[t],this._valuesEnd[t]=e},t}(),u="18.6.4",p=h.nextId,g=l,d=g.getAll.bind(g),m=g.removeAll.bind(g),f=g.add.bind(g),y=g.remove.bind(g),_=g.update.bind(g);const x={Easing:r,Group:n,Interpolation:o,now:a,Sequence:h,nextId:p,Tween:c,VERSION:u,getAll:d,removeAll:m,add:f,remove:y,update:_}}},e={};function i(s){var r=e[s];if(void 0!==r)return r.exports;var a=e[s]={exports:{}};return t[s](a,a.exports,i),a.exports}i.d=(t,e)=>{for(var s in e)i.o(e,s)&&!i.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{const t=window.innerWidth,e=window.innerHeight,s={x1:t/4,x2:t-t/4,y1:e/4,y2:e-e/4},r={SPRITES_FOLDER:"./assets/sprites/",SOUND_FOLDER:"./assets/sounds/",GAME_SPEED:45,GAME_WIDTH:t,GAME_HEIGHT:e,GAME_MID_H:t/2,GAME_MID_V:e/2,CENTER_LIMITS:s,CENTER_VOID:{x:s.x1,y:s.y1,w:s.x2-s.x1,h:s.y2-s.y1}},a=[{x:0,y:0,h:105,w:121,sheet:{x:0,y:0,h:105,w:121,image:"a1.png",frameTotal:1}},{x:0,y:0,h:105,w:121,sheet:{x:0,y:0,h:105,w:121,image:"a1.png",frameTotal:1}},{x:0,y:0,h:105,w:121,sheet:{x:0,y:0,h:105,w:121,image:"a1.png",frameTotal:1}}],n=[{x:0,y:0,w:107,h:106,sheet:{image:"a2.png",x:0,y:0,w:107,h:106,frameTotal:1}},{x:0,y:0,w:112,h:89,sheet:{image:"a3.png",x:0,y:0,w:107,h:106,frameTotal:1}}],o=[{type:"A",name:"A",chance:[1,50],sheet:{image:"asteroid-samples.png",x:0,y:0,w:32,h:32,frameTotal:1}},{type:"B",name:"B",chance:[51,75],sheet:{image:"asteroid-samples.png",x:0,y:32,w:32,h:32,frameTotal:1}},{type:"C",name:"C",chance:[76,90],sheet:{image:"asteroid-samples.png",x:0,y:64,w:32,h:32,frameTotal:1}},{type:"D",name:"D",chance:[91,100],sheet:{image:"asteroid-samples.png",x:0,y:96,w:32,h:32,frameTotal:1}}],h={engine:"engines.wav",miningclick:"miningclick.wav",asteroidEmpty:"asteroidempty.wav",mineralFound:"mineralfound.wav",pickoupcoin:"pickupcoin.wav",powerup23:"powerup23.wav"};class l{static random(t,e){return Math.floor(Math.random()*(e-t+1)+t)}static colision(t,e){return t.x+t.w>e.x&&t.y+t.h>e.y&&t.x<e.x+e.w&&t.y<e.y+e.h}static isHiting(t,e){return!!e&&(t.x>=e.x-e.w/2&&t.x<=e.x+e.w+e.w/2&&t.y>=e.y-e.h/2&&t.y<=e.y+e.w+e.h/2)}static toRadiants(t){return t*(Math.PI/180)}static radiants(t,e,i){if(e){const i=t.x-e.x,s=t.y-e.y;return Math.atan2(i,s)}if(i)return l.toRadiants(i)}static pathLinear(t,e,i){const s=e.x-t.x,r=e.y-t.y,a=Math.floor(Math.abs(r/i)),n=Math.floor(Math.abs(s/i)),o=n>a;let h={x:t.x,y:t.y},l=[];const c=o?n:a,u=i/(n/a),p=i/(a/n);for(let t=0;t<c;t++)o?(e.y<h.y?h.y=h.y-u:h.y=h.y+u,e.x<h.x?h.x=h.x-i:h.x=h.x+i):(e.y<h.y?h.y=h.y-i:h.y=h.y+i,e.x<h.x?h.x=h.x-p:h.x=h.x+p),l.push({...h});return l}}const c=i(194);class u{id;y;x;h;w;frameX;frameY;frameW;frameH;frameVertical;frameTotal;frameCurrent;sheet;target;r;path;currentPathPosition;currentPosition;previousPosition;hits;hitsLimit;loops;currentLoop;scaleX;scaleY;image;moving;mini;metadata;fixed;internalState;constructor(t){this.id=t.id,this.y=t.y,this.x=t.x,this.h=t.h,this.w=t.w,this.frameX=t.frameX||0,this.frameY=t.frameY||0,this.frameW=t.frameW||this.w,this.frameH=t.frameH||this.h,this.frameVertical=t.frameDirection,this.target=t.target,this.r=t.r,this.sheet=t.sheet,this.frameTotal=t.frameTotal||1,this.frameCurrent=0,this.path=[],this.currentPathPosition=0,this.currentPosition=void 0,this.previousPosition=void 0,this.hits=0,this.hitsLimit=t.hitsLimit?t.hitsLimit:1,this.loops=t.loops,this.currentLoop=0,this.scaleX=t.scaleX||1,this.scaleY=-t.scaleY||1,this.moving=!1,this.mini=t.mini||!1,this.metadata=t.metadata,this.sheet&&this.updateImage(),this.internalState={rotationInterval:void 0},this.fixed=t.fixed||!1}updateImage(){var t=new Image;t.src=r.SPRITES_FOLDER+this.sheet,this.image=t}framing(){this.frameVertical?this.frameY=this.frameCurrent*this.frameH:this.frameX=this.frameCurrent*this.frameW,this.frameCurrent<this.frameTotal-1?this.frameCurrent++:this.frameCurrent=0}flipVertically(t){1==Math.sign(t)?this.scaleY=-Math.abs(this.scaleY):this.scaleY=Math.abs(this.scaleY)}flipHorizontally(t){1==Math.sign(t)?this.scaleX=-Math.abs(this.scaleX):this.scaleX=Math.abs(this.scaleX)}colisionWith(t){const e=this;return t.find((t=>l.colision(t,e)))}draw(){this.fixed||this.positionByHero(),this.isVisible()?(this.framing(),ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(-this.r),ctx.scale(this.scaleX,this.scaleY),ctx.drawImage(this.image,this.frameX,this.frameY,this.frameW,this.frameH,0-this.w/2,0-this.h/2,this.w,this.h),ctx.restore()):this.mini&&this.drawMini(),this.tweenUpdate()}tweenUpdate(){c.update()}drawMini(){const t={x:0,y:0};this.x+this.w<0&&(t.x=0),this.x>g.VisibleArea.w&&(t.x=g.VisibleArea.w-this.w/4),this.x>=0&&this.x<=g.VisibleArea.w&&(t.x=this.x),this.y+this.y<0&&(t.y=0),this.y>g.VisibleArea.h&&(t.y=g.VisibleArea.h-this.w/4),this.y>=0&&this.y<=g.VisibleArea.h&&(t.y=this.y),ctx.drawImage(this.image,this.frameX,this.frameY,this.frameW,this.frameH,t.x,t.y,this.w/4,this.h/4)}setPath(t){this.currentPathPosition=0;const e={x:this.x,y:this.y};let i={x:t.x,y:t.y};this.path=l.pathLinear(e,i,g.Speed),this.internalState.rotationInterval=new c.Tween({r:this.r}).to({r:l.radiants(e,i)},550).easing(c.Easing.Cubic.Out).onUpdate((t=>this.r=t.r)).start()}going(){const t=this.currentPathPosition;this.path[t]?(this.currentPosition=this.path[t],this.previousPosition=this.path[t>0?t-1:t],this.moving=!0,this.x=this.path[t].x,this.y=this.path[t].y,this.currentPathPosition++):this.moving=!1}hit(){this.hits++}looping(){this.currentLoop++}fadeOut(){this.currentLoop<this.loops&&(this.y=this.y-2)}positionByHero(){g.Hero.goingTop&&(this.y=this.y+g.Speed),g.Hero.goingRight&&(this.x=this.x-g.Speed),g.Hero.goingBottom&&(this.y=this.y-g.Speed),g.Hero.goingLeft&&(this.x=this.x+g.Speed)}isVisible(){return l.colision(g.VisibleArea,{x:this.x-this.w,y:this.y-this.h,w:this.w+this.w,h:this.h+this.h})}}class p{static play(t){new Audio(r.SOUND_FOLDER+h[t]).play()}}class d extends u{text;color;colorLine;size;align;constructor(t){super(t),this.text=t.text,this.color=t.color,this.colorLine=t.colorLine,this.size=t.size,this.align=t.align||"start"}draw(){this.fadeOut(),ctx.font=`${this.size}px ArcadeClassic`,ctx.fillStyle=this.color,ctx.textAlign="end",ctx.fillText(this.text,this.x,this.y),ctx.strokeStyle=this.colorLine,ctx.strokeText(this.text,this.x,this.y),this.looping()}static hiting(t,e,i,s){const r=new d({id:t,text:"+"+e,x:i,y:s,color:"white",colorLine:"black",size:32,loops:30});g.HitsLabels.push(r)}}class m extends u{goingLeft;goingRight;goingTop;goingBottom;xp;cargoMineralsFull;cargoMineralsPositions;cargoMinerals;constructor(t){super(t),this.goingLeft=!1,this.goingRight=!1,this.goingTop=!1,this.goingBottom=!1,this.resetCargo()}draw(){this.checkDirection(),this.going(),ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(-this.r),ctx.scale(this.scaleX,this.scaleY),ctx.drawImage(this.image,this.frameX,this.frameY,this.w,this.h,0-this.w/2,0-this.h/2,this.w,this.h),this.cargoMinerals.forEach((t=>{ctx.drawImage(t.image,t.frameX,t.frameY,t.frameW,t.frameH,t.x,t.y,t.w,t.h)})),ctx.restore(),this.tweenUpdate()}click(t){l.isHiting(t,g.CurrentAsteroid)||p.play("engine"),this.setPath({x:t.x,y:t.y})}mining(t,e,i,s){this.xp+=t,g.XpTotal+=t,d.hiting("hit_"+e,t,i,s)}addCargoMineral(){this.xp+=8;const t=this.getCargoMineralsPosition(),e=g.CurrentAsteroid.mineral,i={name:e.name,chance:e.chance,type:e.type},s=new u({id:"cargo-"+g.CurrentAsteroid.id,metadata:i,frameX:e.sheet.x,frameY:e.sheet.y,frameW:e.sheet.w,frameH:e.sheet.h,sheet:e.sheet.image,x:t.x,y:t.y,w:this.w/2,h:this.w/2});this.cargoMinerals.push(s),0===this.cargoMineralsPositions.length&&(this.cargoMineralsFull=!0)}getCargoMineralsPosition(){return this.cargoMineralsPositions.pop()}unloadCargo(){g.InCentral&&g.Hero.xp>0&&(p.play("powerup23"),d.hiting("hit_central",g.Hero.xp,g.Hero.x,g.Hero.y),g.XpTotal+=this.xp,this.cargoMinerals.forEach((t=>g.MineralsTotal.push(t.metadata.type))),this.resetCargo(),g.Inventory.updateMinerals())}resetCargo(){this.xp=0,this.cargoMineralsFull=!1,this.cargoMinerals=[],this.cargoMineralsPositions=[{x:0,y:0},{x:0,y:0-this.w/2},{x:0-this.w/2,y:0},{x:0-this.w/2,y:0-this.w/2}]}checkDirection(){this.currentPosition&&(this.goingTop=this.currentPosition.y<this.previousPosition.y&&this.y<g.Margin&&g.Anchor.y+g.Anchor.h+g.Speed<g.LevelLimits.b,this.goingRight=this.currentPosition.x>this.previousPosition.x&&this.x>r.GAME_WIDTH-g.Margin&&g.Anchor.x-g.Speed>g.LevelLimits.l,this.goingBottom=this.currentPosition.y>this.previousPosition.y&&this.y+this.h>r.GAME_HEIGHT-g.Margin&&g.Anchor.y-g.Speed>g.LevelLimits.t,this.goingLeft=this.currentPosition.x<this.previousPosition.x&&this.x<g.Margin&&g.Anchor.x+g.Anchor.w+g.Speed<g.LevelLimits.r)}}class f extends u{constructor(t){super(t)}draw(){this.fixed||this.positionByHero(),this.isVisible()&&ctx.drawImage(this.image,this.frameX,this.frameY,this.frameW,this.frameH,this.x,this.y,this.w,this.h)}positionByHero(){g.bkgProportion=2,g.Hero.goingTop&&(this.y=this.y+g.Speed/g.bkgProportion),g.Hero.goingRight&&(this.x=this.x-g.Speed/g.bkgProportion),g.Hero.goingBottom&&(this.y=this.y-g.Speed/g.bkgProportion),g.Hero.goingLeft&&(this.x=this.x+g.Speed/g.bkgProportion)}}class y extends u{mineral;modelCurrent;modelNew;empty;constructor(t){super(t),this.mineral=t.mineral,this.empty=!1}click(t){if(!g.Hero.cargoMineralsFull&&!g.CurrentAsteroid.empty&&g.CurrentAsteroid.mineral&&g.CurrentAsteroid.isClickIn(t)){switch(this.hit(),this.hits){case 3:this.modelNew=0,g.Hero.mining(3,this.id,this.x,this.y),p.play("pickoupcoin");break;case 6:this.modelNew=1,g.Hero.mining(5,this.id,this.x,this.y),p.play("pickoupcoin");break;default:p.play("miningclick")}if(this.modelCurrent!=this.modelNew){this.modelCurrent=this.modelNew;let t=n[this.modelCurrent];g.Asteroids=g.Asteroids.map((e=>(e.id===this.id&&(e.h=t.h,e.w=t.w,e.sheet=t.sheet.image,e.updateImage()),e)))}this.hits===this.hitsLimit&&(this.setEmpty(),g.Hero.addCargoMineral())}}setEmpty(){p.play("asteroidEmpty"),this.empty=!0,this.sheet="a-empty.png",this.updateImage()}isClickIn(t){return l.isHiting(t,this)}}class _{static create(t){const e=this.getModel();return new y({id:"asteroid_"+t,x:e.x,y:e.y,w:e.w,h:e.h,sheet:e.sheet.image,frameTotal:e.sheet.frameTotal,scaleX:Math.random()<.5?-1:1,scaleY:Math.random()<.5?-1:1,r:l.radiants(void 0,void 0,180*Math.random()),hitsLimit:9,mineral:this.getMineral()})}static createGroup(){const t=this;for(let e=0;e<g.AsteroidsNumber;e++)g.Asteroids.push(t.create(e.toString()))}static getMineral(){const t=l.random(1,100);return o.find((e=>t>=e.chance[0]&&t<=e.chance[1]))}static getModel(){const t=a[l.random(0,a.length-1)],e={...t,x:l.random(-g.OffSetHorizontal+t.w/2,r.GAME_WIDTH+g.OffSetHorizontal-t.w/2),y:l.random(-g.OffSetVertical+t.h/2,g.OffSetVertical+r.GAME_HEIGHT-t.h/2)},i=l.colision(e,r.CENTER_VOID),s=g.Asteroids.some((t=>l.colision(t,e)));return i||s?this.getModel():e}}class x extends u{constructor(t){super(t),this.currentLoop=0,this.loops=3}draw(){g.CurrentAsteroid&&(g.CurrentAsteroid.empty||(this.x=g.CurrentAsteroid.x,this.y=g.CurrentAsteroid.y,this.looping(),this.currentLoop===this.loops&&(this.r++,this.r=this.r>360?0:this.r++,this.currentLoop=0),ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(this.r),ctx.drawImage(this.image,this.frameX,this.frameY,this.w,this.h,0-this.w/2,0-this.h/2,this.w,this.h),ctx.restore()))}}class w extends u{color;alpha;constructor(t){super(t),this.color=t.color,this.alpha=t.alpha}draw(){ctx.save(),ctx.fillStyle=this.color,ctx.fillRect(this.x,this.y,this.w,this.h),ctx.globalAlpha=this.alpha,ctx.restore()}}class v{background;minerals;mineralsTypes;mineralsAccount;slots;constructor(){this.create()}create(){this.background=new f({id:"inventory",w:600,h:600,frameX:0,frameY:50,frameW:190,frameH:97,sheet:"ui.png",frameTotal:1,fixed:!0}),this.background.x=(r.GAME_WIDTH-this.background.w)/2,this.background.y=(r.GAME_HEIGHT-this.background.h)/2,this.mineralsAccount=[],this.mineralsTypes=[]}draw(){}getMineral(t){return o.find((e=>e.type===t))}updateMinerals(){g.MineralsTotal.forEach((t=>{this.mineralsTypes.includes(t)||(this.mineralsTypes.push(t),this.mineralsAccount.push({type:t,qty:1}))})),this.mineralsAccount=this.mineralsAccount.map((t=>(t.qty=g.MineralsTotal.filter((e=>e===t.type)).length,t)))}}class M{panel;xp;xpIcon;money;moneyIcon;constructor(){this.create()}create(){this.panel=new f({fixed:!0,id:"ui_panel",x:r.GAME_WIDTH/2-150,y:r.GAME_HEIGHT/30,w:300,h:75,frameX:0,frameY:0,frameW:190,frameH:49,totaFrames:1,sheet:"ui.png"}),this.xp=new d({x:this.panel.x+this.panel.w-40,y:this.panel.y+28,size:24,color:"black",colorLine:"black",align:"end"}),this.xpIcon=new u({fixed:!0,x:this.xp.x+15,y:this.xp.y-5,w:30,h:30,frameX:0,frameY:0,frameW:17,frameH:18,frameVertical:!1,frameTotal:1,sheet:"xpicon.png"}),this.money=new d({x:this.panel.x+this.panel.w-40,y:this.panel.y+54,size:24,color:"black",colorLine:"black",align:"end"}),this.moneyIcon=new u({fixed:!0,x:this.money.x+15,y:this.money.y-5,w:30,h:30,frameX:0,frameY:0,frameW:17,frameH:18,frameVertical:!1,frameTotal:1,sheet:"moneyicon.png"})}draw(){this.xp.text=g.XpTotal.toString(),this.money.text=g.MoneyTotal.toString(),this.panel.draw(),this.xp.draw(),this.xpIcon.draw(),this.money.draw(),this.moneyIcon.draw()}}const T=document.getElementById("canvas");function b(){switch(ctx.clearRect(0,0,r.GAME_WIDTH,r.GAME_HEIGHT),g.CurrentScreen){case"levelStart":g.LevelLimits={t:-g.OffSetVertical,r:r.GAME_WIDTH+g.OffSetHorizontal,b:r.GAME_HEIGHT+g.OffSetVertical,l:-g.OffSetHorizontal},g.SetNewGame&&(g.GameOver=!1,g.SetNewGame=!1,g.Background=new w({x:0,y:0,w:r.GAME_WIDTH,h:r.GAME_HEIGHT,color:"#2c2137",alpha:1}),g.Anchor=new u({id:"anchor",x:0,y:0,w:r.GAME_WIDTH,h:r.GAME_HEIGHT}),g.VisibleArea=new w({id:"visiblArea",x:0,y:0,w:r.GAME_WIDTH,h:r.GAME_HEIGHT}),g.Stars=Array.from({length:1e3},(function(t,e){return new f({id:"star_"+e,x:l.random(g.LevelLimits.l,g.LevelLimits.r),y:l.random(g.LevelLimits.t,g.LevelLimits.b),w:30,h:30,frameX:50*l.random(0,4),frameY:50*l.random(0,4),frameW:50,frameH:50,totaFrames:1,sheet:"stars.png"})})),g.AsteroidsNumber=75,_.createGroup(),g.Central=new u({id:"central",x:r.GAME_WIDTH/2,y:r.GAME_HEIGHT/2,w:91,h:90,sheet:"central.png",frameTotal:1,r:20,scaleX:2,scaleY:2,mini:!0}),g.Hero=new m({id:"hero",x:r.GAME_MID_H,y:r.GAME_MID_V,h:74,w:50,sheet:"ship.png",frameTotal:1,r:0,scaleX:1,scaleY:1}),g.Hero.target={x:g.Hero.x,y:g.Hero.y},g.Crosshair=new x({id:"crosshair",h:64,w:64,sheet:"crosshair158.png",frameTotal:1,r:0}),g.Inventory=new v,g.UiPanel=new M),g.CurrentScreen="action",g.MarkTime=0,g.GlobalTime=0,document.body.addEventListener("click",(function(t){g.Hero.click(t),g.CurrentAsteroid?.click(t)}));break;case"action":g.CurrentAsteroid=g.Hero.colisionWith(g.Asteroids),g.InCentral="object"==typeof g.Hero.colisionWith([g.Central]),g.Hero.unloadCargo(),g.Anchor.positionByHero(),g.Background.draw(),g.Stars.forEach((t=>{t.draw()})),g.Asteroids.forEach((t=>t.draw())),g.Central.draw(),g.Hero.draw(),g.Crosshair.draw(),g.HitsLabels.forEach((t=>t.draw())),g.HitsLabels=g.HitsLabels.filter((t=>t.currentLoop<t.loops)),g.Inventory.draw(),g.UiPanel.draw()}}T.width=r.GAME_WIDTH,T.height=r.GAME_HEIGHT,globalThis.g=new class{GlobalTime;MarkTime;Speed;CurrentScreen;GameOver;Pause;SetNewGame;Background;Hero;Central;Crosshair;AsteroidsNumber;Asteroids;CurrentAsteroid;CargoTotal;XpTotal;MoneyTotal;MineralsTotal;InCentral;HitsLabels;OffSetHorizontal;OffSetVertical;bkgProportion;Stars;Margin;Anchor;VisibleArea;LevelLimits;Inventory;UiPanel;constructor(){this.GlobalTime=0,this.MarkTime=0,this.Speed=10,this.CurrentScreen="levelStart",this.GameOver=!1,this.Pause=!1,this.SetNewGame=!0,this.Asteroids=[],this.AsteroidsNumber=0,this.CargoTotal=0,this.InCentral=!1,this.HitsLabels=[],this.bkgProportion=4,this.OffSetHorizontal=r.GAME_WIDTH,this.OffSetVertical=r.GAME_HEIGHT,this.Stars=[],this.Margin=100,this.MineralsTotal=[],this.XpTotal=0,this.MoneyTotal=0}},globalThis.ctx=T.getContext("2d"),setInterval((function(){g.GlobalTime=g.GlobalTime+.5}),500);setInterval(b,r.GAME_SPEED)})()})();